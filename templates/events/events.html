{% extends "base.html" %}

{% block title %}Events - Campus Connect{% endblock %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <h1><i class="fas fa-calendar"></i> Campus Events</h1>
        <button class="btn btn-primary" onclick="openModal('addEventModal')">
            <i class="fas fa-plus"></i> Post Event
        </button>
    </div>
    
    <div class="events-timeline">
        {% for event in events %}
        <div class="event-card">
            <div class="event-date">
                <div class="event-day">{{ event.event_date.split('-')[2] }}</div>
                <div class="event-month">
                    {% set month_names = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'] %}
                    {{ month_names[event.event_date.split('-')[1]|int - 1] }}
                </div>
            </div>
            <div class="event-content">
                <h3>{{ event.title }}</h3>
                <p class="event-description">{{ event.description }}</p>
                <div class="event-meta">
                    <div class="event-location">
                        <i class="fas fa-map-marker-alt"></i>
                        {{ event.location }}
                    </div>
                    <div class="event-organizer">
                        <i class="fas fa-user"></i>
                        by {{ event.organizer_name }}
                    </div>
                </div>
                {% if event.registration_link %}
                <div class="event-actions">
                    <a href="{{ event.registration_link }}" target="_blank" class="btn btn-primary btn-small">
                        <i class="fas fa-external-link-alt"></i> Register
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    
    {% if not events %}
    <div class="empty-state">
        <i class="fas fa-calendar-plus"></i>
        <h3>No events posted yet</h3>
        <p>Be the first to post an event for your fellow students!</p>
    </div>
    {% endif %}
</div>

<!-- Add Event Modal -->
<div id="addEventModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Post New Event</h3>
            <span class="close" onclick="closeModal('addEventModal')">&times;</span>
        </div>
        <form method="POST" action="{{ url_for('add_event') }}" class="modal-form">
            <div class="form-group">
                <label for="title">Event Title</label>
                <input type="text" id="title" name="title" required>
            </div>
            
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" required></textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="event_date">Event Date</label>
                    <input type="date" id="event_date" name="event_date" required>
                </div>
                
                <div class="form-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" name="location" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="registration_link">Registration Link (Optional)</label>
                <input type="url" id="registration_link" name="registration_link" 
                       placeholder="https://forms.google.com/...">
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addEventModal')">
                    Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Post Event
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}